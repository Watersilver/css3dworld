(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function e(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(o){if(o.ep)return;o.ep=!0;const n=e(o);fetch(o.href,n)}})();const m={};document.addEventListener("keydown",s=>m[s.key]=!0);document.addEventListener("keyup",s=>m[s.key]=!1);const d={keyboard:m};class u extends Array{add(t){for(const e in t)this[e]+=t[e]}}class h{constructor(t){t.classList.add("camera"),this._cameraElem=t,this._orientation=new Quaternion,this._position=new u(0,0,0),this._transform();const e=()=>{this._transform(),requestAnimationFrame(e)};requestAnimationFrame(e)}rotate(t,e){const r=new Quaternion.fromAxisAngle(t,e);this._orientation=this._orientation.mul(r)}rotateX(t){this.rotate([1,0,0],t)}rotateY(t){this.rotate([0,1,0],t)}rotateZ(t){this.rotate([0,0,1],t)}move(t){this._position.add(this._orientation.rotateVector(t))}moveForward(t){this.move([0,0,-t])}moveBackward(t){this.move([0,0,t])}moveLeft(t){this.move([-t,0,0])}moveRight(t){this.move([t,0,0])}_transform(){const t=this._position;this._cameraElem.style.transformOrigin=`
      calc(50% + ${t[0]}mm)
      calc(50% + ${t[1]}mm)
      calc(var(--persp) + ${t[2]}mm)
    `,this._cameraElem.style.transform=`
      translateX(${-t[0]}mm)
      translateY(${-t[1]}mm)
      translateZ(${-t[2]}mm)
      matrix3d(${this._orientation.toMatrix4()})
    `}}class a extends Array{getMagnitude(){let t=0;for(const e of this)t+=e**2;return Math.sqrt(t)}getNormal(){const t=new a,e=this.getMagnitude(),r=e!==0?1/e:1;for(const o in this)t[o]=this[o]*r;return t}multiply(t){const e=new a;for(const r in this)e[r]=this[r]*t;return e}}const{keyboard:i}=d,l=new h(document.querySelector("#world-wrapper .camera")),p=60,y=1;let f=performance.now();setInterval(()=>{const s=performance.now(),t=(s-f)*.001;let e=new a(0,0,0);i.w&&(e[2]+=-1),i.a&&(e[0]+=-1),i.s&&(e[2]+=1),i.d&&(e[0]+=1),i[2]&&(e[1]+=-1),i.x&&(e[1]+=1),e=e.getNormal().multiply(p*t),l.move(e);const r=new a(0,0,0);i.q&&(r[2]+=-1),i.e&&(r[2]+=1),i.ArrowLeft&&(r[1]+=1),i.ArrowRight&&(r[1]+=-1),i.ArrowUp&&(r[0]+=1),i.ArrowDown&&(r[0]+=-1),r.getMagnitude()&&l.rotate(r,y*t),f=s});
